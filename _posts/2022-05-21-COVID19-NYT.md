## SQL Project #1. Analyzing 2022 COVID-19 data in the United States

For my first project using SQL I decided to look at publicly available COVID-19 data. [Here](https://github.com/nytimes/covid-19-data) is a link to the public dataset I used, provided by The New York Times (NYT).

![image](https://user-images.githubusercontent.com/105367716/169653225-ddd37ebd-b429-487e-b96d-d43e1bec5758.png)

I'm most interested in the us-counties-2022.csv file seen above, which contains the columns: date, state, fips, cases and deaths so far this year. Note: Fips is NULL if a county actually reports multiple counties. E.g New York City compromises New York, Kings, Queens, Bronx and Richmond Counties and has a NULL fips value.

To accomodate for us-counties-2022.csv in PostgreSQL, I created the table us_countries_2022 using the query below. I ommitted using constraints as I'm unable to see the need for them in this case. With this table made I then imported us-counties-2022.csv into us_countries_2022
```
CREATE TABLE us_counties_2022(
    date DATE,
    county VARCHAR(50),
    state VARCHAR(50),
    fips INTEGER,
    cases INTEGER,
    deaths INTEGER
);
```

## With this data I plan on answering these questions for my first project:
1. What are the top 10 counties by total cases so far this year?
2. What are the top 10 states by total cases so far this year?
3. Which 10 counties has the highest deaths:cases ratio so far this year?
4. Which 10 states has the highest deaths:cases ratio so far this year?
5. What are the top 10 states by deaths:population ratio so far this year and is their governor a Democrat or Republican?

### Question 1 answer - What are the top 10 counties by total cases so far this year?
Here is the query I used:
```
SELECT county,fips,SUM(cases) AS total_cases FROM us_counties_2022
GROUP BY county,fips
ORDER BY SUM(cases) DESC
LIMIT 10;
```
Here is the result:

![image](https://user-images.githubusercontent.com/105367716/169656258-581c6977-fe0b-48e4-9771-f5d82c14967b.png)

What if I didn't want to include counties that actually compromise of several counties? Here is the query I would use instead:
```
SELECT county,fips,SUM(cases) AS total_cases FROM us_counties_2022
WHERE fips IS NOT NULL
GROUP BY county,fips
ORDER BY SUM(cases) DESC
LIMIT 10;
```

Resulting in this:

![image](https://user-images.githubusercontent.com/105367716/169656286-11c55961-bded-490f-8691-78486cbbcaa1.png)

### Question 2 answer - What are the top 10 states by total cases so far this year?
Here is the query I used:
```
SELECT state,SUM(cases) AS total_cases FROM us_counties_2022
GROUP BY state
ORDER BY SUM(cases) DESC
LIMIT 10;
```
Here is the result:

![image](https://user-images.githubusercontent.com/105367716/169656300-34bc9c82-f5ee-4f63-a28c-4c0357fd55a7.png)

### Question 3 answer - Which 10 counties has the highest deaths:cases ratio so far this year?
Here is the query I used:
```
SELECT county,
SUM(deaths) AS total_deaths,
SUM(cases) AS total_cases,
ROUND((SUM(deaths) * 1.0 / SUM(cases) * 1.0),4) AS deaths_cases_ratio
FROM us_counties_2022
WHERE deaths IS NOT NULL AND cases IS NOT NULL
GROUP BY county
ORDER BY deaths_cases_ratio DESC
LIMIT 10;
```
The line 'WHERE deaths IS NOT NULL AND cases IS NOT NULL' is necessary here. Without it all of the 10 death:cases ratio results will return the NULL value.

Here is the result:

![image](https://user-images.githubusercontent.com/105367716/169657025-8b169d21-615c-4e4c-8d25-2379daed986f.png)

### Question 4 answer - Which 10 states has the highest deaths:cases ratio so far this year?
Here is the query I used:
```
SELECT state,
SUM(deaths) AS total_deaths,
SUM(cases) AS total_cases,
ROUND((SUM(deaths) * 1.0 / SUM(cases) * 1.0),4) AS deaths_cases_ratio
FROM us_counties_2022
GROUP BY state
ORDER BY deaths_cases_ratio DESC
LIMIT 10;
```

Here is the result:

![image](https://user-images.githubusercontent.com/105367716/169657541-7f89b80f-a361-4253-a204-854b6df67f67.png)

### Question 5 answer - What are the top 10 states by deaths:population ratio so far this year and is their governor a Democrat or Republican?
To answer this question I need to know each states population, governor and political party which the NYT dataset doesn't contain. So I made a table in Excel with the relevant data myself as seen below. [Here is a link to the file - state_info.csv](https://github.com/robertjspencer/robertjspencer.github.io/files/8747916/state_info.csv).

![image](https://user-images.githubusercontent.com/105367716/169659390-90b0abdf-03f9-4ee8-9383-63f8f3056924.png)
##### The population data was [retrieved from the United States Census Bureau](https://www.census.gov/data/tables/time-series/demo/popest/2020s-state-total.html#par_textimage). The population data used was the 2021 population estimate.

I then created a table using the query below:
```
CREATE TABLE state_info(
    state VARCHAR(50) PRIMARY KEY,
    population INTEGER,
    governor VARCHAR(50),
    political_party VARCHAR(20)
)
```
And then imported state_info.csv into this table.
